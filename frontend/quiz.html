<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Œnologique - Cité du Vin</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Additional Quiz-specific styles */
        .quiz-badge {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            margin: 0 auto 2rem;
            color: white;
            font-weight: 700;
            font-size: 1.2rem;
            position: relative;
            overflow: hidden;
        }
        
        .quiz-badge::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(255,255,255,0.4) 0%, rgba(255,255,255,0) 50%);
            z-index: 1;
        }
        
        .badge-novice {
            background: linear-gradient(45deg, #8B0000, #B80000);
        }
        
        .badge-amateur {
            background: linear-gradient(45deg, #8B4513, #CD853F);
        }
        
        .badge-connoisseur {
            background: linear-gradient(45deg, #4B0082, #9370DB);
        }
        
        .badge-sommelier {
            background: linear-gradient(45deg, #DAA520, #FFD700);
        }
        
        .badge-master {
            background: linear-gradient(45deg, #2F4F4F, #2E8B57);
        }
        
        .badge-icon {
            font-size: 3rem;
            margin-bottom: 0.5rem;
        }
        
        .badge-title {
            font-size: 1.2rem;
        }
        
        .badge-subtitle {
            font-size: 0.9rem;
            opacity: 0.9;
        }
        
        .aroma-wheel {
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
            position: relative;
        }
        
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background-color: #f00;
            position: absolute;
            top: 0;
            z-index: 10000;
            pointer-events: none;
        }
        
        .quiz-progress-steps {
            display: flex;
            justify-content: space-between;
            margin-bottom: 1.5rem;
            position: relative;
        }
        
        .quiz-progress-steps::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 2px;
            background-color: var(--border-color);
            z-index: 1;
        }
        
        .progress-step {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: white;
            border: 2px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            position: relative;
            z-index: 2;
            transition: all 0.3s;
        }
        
        .progress-step.active {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
            color: white;
        }
        
        .progress-step.completed {
            background-color: var(--success-color);
            border-color: var(--success-color);
            color: white;
        }
        
        .quiz-mode-selector {
            display: flex;
            flex-wrap: wrap;
            gap: 1.5rem;
            justify-content: center;
            margin-bottom: 2rem;
        }
        
        .quiz-mode-card {
            background-color: white;
            border-radius: var(--border-radius-large);
            box-shadow: var(--shadow);
            width: 280px;
            padding: 2rem;
            text-align: center;
            transition: all 0.3s;
            cursor: pointer;
            border: 2px solid transparent;
        }
        
        .quiz-mode-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-large);
        }
        
        .quiz-mode-card.selected {
            border-color: var(--primary-color);
            background-color: var(--primary-lighter);
        }
        
        .quiz-mode-icon {
            font-size: 3rem;
            color: var(--primary-color);
            margin-bottom: 1rem;
        }
        
        .quiz-mode-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
        
        .quiz-mode-description {
            color: var(--text-light);
            font-size: 0.9rem;
            margin-bottom: 1rem;
        }
        
        .quiz-difficulty {
            display: flex;
            justify-content: center;
            gap: 0.25rem;
            margin-top: 1rem;
        }
        
        .difficulty-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background-color: var(--gray-light);
        }
        
        .difficulty-dot.active {
            background-color: var(--primary-color);
        }
        
        .wine-card-3d {
            perspective: 1000px;
            width: 250px;
            height: 300px;
        }
        
        .wine-card-inner {
            width: 100%;
            height: 100%;
            transform-style: preserve-3d;
            transition: transform 0.6s;
            position: relative;
        }
        
        .wine-card-3d.flipped .wine-card-inner {
            transform: rotateY(180deg);
        }
        
        .wine-card-front, .wine-card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: var(--border-radius);
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .wine-card-front {
            background-color: var(--primary-color);
            color: white;
        }
        
        .wine-card-back {
            background-color: white;
            transform: rotateY(180deg);
            box-shadow: var(--shadow);
            flex-direction: column;
            padding: 1.5rem;
            text-align: center;
        }
        
        .wine-card-question {
            font-size: 1.5rem;
            text-align: center;
            padding: 2rem;
        }
        
        .wine-card-wine-title {
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
        
        .wine-card-wine-details {
            color: var(--text-light);
            font-size: 0.9rem;
            margin-bottom: 1rem;
        }
        
        .image-quiz-option {
            position: relative;
            overflow: hidden;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: transform 0.3s;
        }
        
        .image-quiz-option:hover {
            transform: scale(1.05);
        }
        
        .image-quiz-option img {
            width: 100%;
            height: 180px;
            object-fit: cover;
        }
        
        .image-quiz-option-label {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(0deg, rgba(0,0,0,0.7) 0%, rgba(0,0,0,0) 100%);
            color: white;
            padding: 1rem;
            font-weight: 600;
        }
        
        .image-quiz-option.selected {
            box-shadow: 0 0 0 3px var(--primary-color);
        }
        
        .image-quiz-option.correct {
            box-shadow: 0 0 0 3px var(--success-color);
        }
        
        .image-quiz-option.incorrect {
            box-shadow: 0 0 0 3px var(--error-color);
        }
        
        .image-quiz-option.disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
    </style>
</head>
<body>
     <!-- Header -->
     <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <img src="assets/images/logo.png" alt="Cité du Vin Logo" id="logo-image">
                    <h1>Cité du Vin</h1>
                </div>
                
                <!-- Search Bar -->
                <form id="search-form" class="search-form">
                    <div class="search-container">
                        <input type="text" id="search-input" placeholder="Rechercher des vins, régions, cépages...">
                        <button type="submit">
                            <i class="fas fa-search"></i> Rechercher
                        </button>
                    </div>
                </form>
                
                <!-- Header Actions -->
                <div class="header-actions">
                    <button type="button" class="cart-btn" id="cart-button">
                        <i class="fas fa-shopping-cart"></i>
                        <span class="cart-badge" id="cart-count">0</span>
                    </button>
                    
                    <!-- Cart Preview (Hidden by default) -->
                    <div class="cart-preview" id="cart-preview">
                        <div class="cart-preview-title">
                            <h3>Votre Panier</h3>
                            <button class="btn-link" id="cart-preview-close">Fermer</button>
                        </div>
                        <div class="cart-preview-items" id="cart-preview-items">
                            <!-- Cart items will be inserted here via JavaScript -->
                        </div>
                        <div class="cart-preview-total">
                            <span>Total:</span>
                            <span id="cart-preview-total-amount">€0.00</span>
                        </div>
                        <div class="cart-preview-actions">
                            <a href="cart.html" class="btn secondary">Voir le panier</a>
                            <a href="checkout.html" class="btn primary">Commander</a>
                        </div>
                    </div>
                    
                    <div class="user-menu">
                        <button type="button" class="user-btn" id="user-button">
                            <i class="fas fa-user-circle"></i>
                            <span>Mon Compte</span>
                        </button>
                        
                        <!-- User Dropdown (Hidden by default) -->
                        <div class="user-dropdown" id="user-dropdown">
                            <a href="account.html" class="dropdown-item">Mon profil</a>
                            <a href="orders.html" class="dropdown-item">Mes commandes</a>
                            <a href="favorites.html" class="dropdown-item">Mes favoris</a>
                            <div class="dropdown-divider"></div>
                            <a href="#" class="dropdown-item" id="logout-button">Déconnexion</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>
    
    <!-- Main Navigation -->
    <nav class="main-nav">
        <div class="container">
            <div class="nav-container">
                <button class="menu-btn" id="menu-button">
                    <i class="fas fa-bars"></i>
                </button>
                
                <ul class="nav-links" id="nav-links">
                    <li class="nav-item">
                        <a href="index.html" class="nav-link active">Accueil</a>
                    </li>
                    <li class="nav-item">
                        <a href="wines.html" class="nav-link">Notre Sélection</a>
                    </li>
                    <li class="nav-item">
                        <a href="regions.html" class="nav-link">Régions Viticoles</a>
                    </li>
                    <li class="nav-item">
                        <a href="experience.html" class="nav-link">Expérience Dégustation</a>
                    </li>
                    <li class="nav-item">
                        <a href="quiz.html" class="nav-link">Quiz Œnologique</a>
                    </li>
                    <li class="nav-item">
                        <a href="blog.html" class="nav-link">Blog</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    
    <!-- Quiz Page Content -->
    <main class="quiz-page">
        <div class="container">
            <div id="quiz-intro" class="quiz-section active">
                <div class="quiz-header text-center">
                    <h1 class="mb-3">Quiz Œnologique</h1>
                    <p class="mb-5">Testez vos connaissances sur le vin et découvrez votre niveau d'expertise œnologique</p>
                </div>
                
                <div class="quiz-mode-selector">
                    <div class="quiz-mode-card" data-mode="classic">
                        <div class="quiz-mode-icon">
                            <i class="fas fa-glass-cheers"></i>
                        </div>
                        <h3 class="quiz-mode-title">Quiz Classique</h3>
                        <p class="quiz-mode-description">Un quiz complet pour tester vos connaissances générales sur le vin</p>
                        <div class="quiz-difficulty">
                            <span class="difficulty-dot active"></span>
                            <span class="difficulty-dot active"></span>
                            <span class="difficulty-dot"></span>
                        </div>
                    </div>
                    
                    <div class="quiz-mode-card" data-mode="regions">
                        <div class="quiz-mode-icon">
                            <i class="fas fa-map-marked-alt"></i>
                        </div>
                        <h3 class="quiz-mode-title">Régions Viticoles</h3>
                        <p class="quiz-mode-description">Testez vos connaissances sur les régions viticoles du monde entier</p>
                        <div class="quiz-difficulty">
                            <span class="difficulty-dot active"></span>
                            <span class="difficulty-dot active"></span>
                            <span class="difficulty-dot active"></span>
                        </div>
                    </div>
                    
                    <div class="quiz-mode-card" data-mode="visual">
                        <div class="quiz-mode-icon">
                            <i class="fas fa-eye"></i>
                        </div>
                        <h3 class="quiz-mode-title">Quiz Visuel</h3>
                        <p class="quiz-mode-description">Identifiez les vins, cépages et régions à partir d'images</p>
                        <div class="quiz-difficulty">
                            <span class="difficulty-dot active"></span>
                            <span class="difficulty-dot active"></span>
                            <span class="difficulty-dot"></span>
                        </div>
                    </div>
                    
                    <div class="quiz-mode-card" data-mode="expert">
                        <div class="quiz-mode-icon">
                            <i class="fas fa-award"></i>
                        </div>
                        <h3 class="quiz-mode-title">Mode Expert</h3>
                        <p class="quiz-mode-description">Pour les véritables connaisseurs, un défi de niveau sommelier</p>
                        <div class="quiz-difficulty">
                            <span class="difficulty-dot active"></span>
                            <span class="difficulty-dot active"></span>
                            <span class="difficulty-dot active"></span>
                        </div>
                    </div>
                </div>
                
                <div class="text-center">
                    <button id="start-quiz-btn" class="btn primary" disabled>
                        Commencer le Quiz
                    </button>
                </div>
            </div>
            
            <div id="quiz-container" class="quiz-section" style="display: none;">
                <div class="quiz-header">
                    <div class="quiz-progress">
                        <div class="quiz-progress-steps" id="progress-steps">
                            <!-- Progress steps will be generated dynamically -->
                        </div>
                        
                        <div class="progress-bar">
                            <div class="progress-fill" id="progress-fill"></div>
                        </div>
                        <div class="progress-text">
                            <span id="progress-current">Question 1</span>
                            <span id="progress-total">sur 10</span>
                        </div>
                    </div>
                </div>
                
                <div class="quiz-content">
                    <div id="question-container" class="question">
                        <!-- Question content will be inserted here -->
                    </div>
                    
                    <div id="feedback-container" class="quiz-feedback" style="display: none;">
                        <!-- Feedback content will be inserted here -->
                    </div>
                    
                    <div class="quiz-actions" id="quiz-actions">
                        <button id="submit-answer-btn" class="btn primary" disabled>
                            Valider ma réponse
                        </button>
                        <button id="next-question-btn" class="btn primary" style="display: none;">
                            Question suivante
                        </button>
                    </div>
                </div>
            </div>
            
            <div id="quiz-results" class="quiz-section" style="display: none;">
                <div class="result-container text-center">
                    <div class="result-icon">
                        <i class="fas fa-trophy"></i>
                    </div>
                    
                    <h2 class="result-title">Félicitations !</h2>
                    
                    <div class="result-score" id="result-score">
                        Votre score: <span id="score-value">8/10</span>
                    </div>
                    
                    <p class="result-message" id="result-message">
                        Excellent ! Vous avez une belle connaissance du monde du vin.
                    </p>
                    
                    <div class="result-badge" id="result-badge">
                        <!-- Badge will be inserted here -->
                    </div>
                    
                    <div class="result-progress">
                        <div class="result-progress-title">Niveau d'expertise</div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="expertise-level-fill"></div>
                        </div>
                        <div class="expertise-levels">
                            <span>Novice</span>
                            <span>Amateur</span>
                            <span>Connaisseur</span>
                            <span>Sommelier</span>
                            <span>Maître</span>
                        </div>
                    </div>
                    
                    <div class="result-details mt-5">
                        <h3 class="mb-3">Détail de vos réponses</h3>
                        
                        <div class="result-questions" id="result-questions">
                            <!-- Results questions will be inserted here -->
                        </div>
                    </div>
                    
                    <div class="result-actions mt-5">
                        <button id="share-results-btn" class="btn primary">
                            <i class="fas fa-share-alt"></i> Partager mes résultats
                        </button>
                        <button id="try-again-btn" class="btn secondary">
                            <i class="fas fa-redo"></i> Réessayer
                        </button>
                        <a href="index.html" class="btn outline">
                            <i class="fas fa-home"></i> Retour à l'accueil
                        </a>
                    </div>
                    
                    <div class="wine-recommendations mt-5">
                        <h3 class="mb-3">D'après vos réponses, vous pourriez aimer</h3>
                        
                        <div class="wines-grid" id="recommendation-container">
                            <!-- Wine recommendations will be inserted here -->
                        </div>
                    </div>
                </div>
            </div>
            
            <div id="quiz-aroma-wheel" class="quiz-section" style="display: none;">
                <div class="aroma-wheel-container">
                    <h2 class="text-center mb-4">La Roue des Arômes du Vin</h2>
                    
                    <div class="aroma-wheel" id="aroma-wheel-container">
                        <!-- Aroma wheel SVG will be inserted here -->
                    </div>
                    
                    <div class="aroma-wheel-legend mt-4">
                        <div class="legend-item">
                            <span class="legend-color" style="background-color: #E57373;"></span>
                            <span class="legend-text">Fruits rouges</span>
                        </div>
                        <div class="legend-item">
                            <span class="legend-color" style="background-color: #FFB74D;"></span>
                            <span class="legend-text">Fruits jaunes</span>
                        </div>
                        <div class="legend-item">
                            <span class="legend-color" style="background-color: #AED581;"></span>
                            <span class="legend-text">Végétal</span>
                        </div>
                        <div class="legend-item">
                            <span class="legend-color" style="background-color: #4FC3F7;"></span>
                            <span class="legend-text">Floral</span>
                        </div>
                        <div class="legend-item">
                            <span class="legend-color" style="background-color: #9575CD;"></span>
                            <span class="legend-text">Épices</span>
                        </div>
                        <div class="legend-item">
                            <span class="legend-color" style="background-color: #A1887F;"></span>
                            <span class="legend-text">Boisé</span>
                        </div>
                    </div>
                    
                    <div class="text-center mt-5">
                        <p>Explorez cette roue interactive pour découvrir les différentes familles d'arômes que l'on peut trouver dans un vin.</p>
                        <button id="close-aroma-wheel-btn" class="btn primary mt-3">
                            Retour au Quiz
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>
    
    <!-- Share Results Modal -->
    <div class="modal" id="share-modal">
        <div class="modal-dialog">
            <div class="modal-header">
                <h3 class="modal-title">Partager mes résultats</h3>
                <button type="button" class="modal-close" id="share-modal-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <p>Partagez votre niveau d'expertise œnologique avec vos amis !</p>
                
                <div class="share-preview">
                    <div class="share-preview-content">
                        <h4>J'ai obtenu le niveau "Connaisseur" au quiz œnologique de la Cité du Vin!</h4>
                        <p>8/10 - Excellent ! J'ai une belle connaissance du monde du vin.</p>
                        <div id="share-badge" class="quiz-badge badge-connoisseur">
                            <span class="badge-icon"><i class="fas fa-wine-glass-alt"></i></span>
                            <span class="badge-title">Connaisseur</span>
                            <span class="badge-subtitle">8/10</span>
                        </div>
                    </div>
                </div>
                
                <div class="share-buttons">
                    <button class="btn outline share-btn" data-platform="facebook">
                        <i class="fab fa-facebook-f"></i> Facebook
                    </button>
                    <button class="btn outline share-btn" data-platform="twitter">
                        <i class="fab fa-twitter"></i> Twitter
                    </button>
                    <button class="btn outline share-btn" data-platform="linkedin">
                        <i class="fab fa-linkedin-in"></i> LinkedIn
                    </button>
                    <button class="btn outline share-btn" data-platform="email">
                        <i class="fas fa-envelope"></i> Email
                    </button>
                </div>
                
                <div class="copy-link-container mt-4">
                    <label for="share-link">Lien direct</label>
                    <div class="copy-link-input">
                        <input type="text" id="share-link" class="form-control" readonly value="https://citeduvin.com/quiz?result=connoisseur&score=8">
                        <button id="copy-link-btn" class="btn primary">Copier</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
     <!-- Footer -->
     <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-column">
                    <h3 class="footer-column-title">À Propos</h3>
                    <ul class="footer-links">
                        <li class="footer-link"><a href="about.html">Notre Histoire</a></li>
                        <li class="footer-link"><a href="terms.html">Conditions Générales</a></li>
                        <li class="footer-link"><a href="privacy.html">Politique de Confidentialité</a></li>
                        <li class="footer-link"><a href="shipping.html">Livraisons & Retours</a></li>
                    </ul>
                </div>
                
                <div class="footer-column">
                    <h3 class="footer-column-title">Découvrir</h3>
                    <ul class="footer-links">
                        <li class="footer-link"><a href="regions.html">Régions Viticoles</a></li>
                        <li class="footer-link"><a href="experience.html">Guide de Dégustation</a></li>
                        <li class="footer-link"><a href="quiz.html">Quiz Œnologique</a></li>
                        <li class="footer-link"><a href="blog.html">Blog & Actualités</a></li>
                    </ul>
                </div>
                
                <div class="footer-column">
                    <h3 class="footer-column-title">Contact</h3>
                    <div class="footer-contact">
                        <div class="footer-contact-item">
                            <div class="footer-contact-icon">
                                <i class="fas fa-map-marker-alt"></i>
                            </div>
                            <div>
                                134 Quai de Bacalan<br>
                                33300 Bordeaux, France
                            </div>
                        </div>
                        <div class="footer-contact-item">
                            <div class="footer-contact-icon">
                                <i class="fas fa-phone"></i>
                            </div>
                            <div>+33 5 56 16 20 20</div>
                        </div>
                        <div class="footer-contact-item">
                            <div class="footer-contact-icon">
                                <i class="fas fa-envelope"></i>
                            </div>
                            <div>contact@citeduvin.com</div>
                        </div>
                    </div>
                </div>
                
                <div class="footer-column">
                    <h3 class="footer-column-title">Newsletter</h3>
                    <p>Inscrivez-vous pour recevoir nos offres et actualités.</p>
                    <form class="newsletter-form">
                        <input type="email" class="newsletter-input form-control" placeholder="Votre email" required>
                        <button type="submit" class="newsletter-button">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </form>
                    <div class="social-links">
                        <a href="#" class="social-link"><i class="fab fa-facebook-f"></i></a>
                        <a href="#" class="social-link"><i class="fab fa-twitter"></i></a>
                        <a href="#" class="social-link"><i class="fab fa-instagram"></i></a>
                        <a href="#" class="social-link"><i class="fab fa-pinterest"></i></a>
                    </div>
                </div>
            </div>
            
            <div class="footer-bottom">
                <div class="copyright">
                    &copy; <span id="current-year"></span> Cité du Vin - Tous droits réservés
                </div>
            </div>
        </div>
    </footer>
    
    <script>
        // Quiz data for demonstration
        const quizData = {
            classic: {
                name: "Quiz Classique",
                description: "Un quiz complet pour tester vos connaissances générales sur le vin",
                questions: [
                    {
                        id: 1,
                        type: "multiple",
                        question: "Quelle est la principale différence entre un vin rouge et un vin blanc ?",
                        options: [
                            "La couleur du raisin utilisé",
                            "La présence ou non de peaux de raisin lors de la fermentation",
                            "La durée de vieillissement en fût de chêne",
                            "Le taux de sucre dans le raisin"
                        ],
                        correctAnswer: 1,
                        explanation: "La principale différence est que les vins rouges fermentent avec les peaux de raisin (macération), tandis que les vins blancs sont généralement pressés avant la fermentation pour séparer le jus des peaux."
                    },
                    {
                        id: 2,
                        type: "multiple",
                        question: "Quel cépage est emblématique de la région de Bourgogne en France ?",
                        options: [
                            "Merlot",
                            "Cabernet Sauvignon",
                            "Pinot Noir",
                            "Syrah"
                        ],
                        correctAnswer: 2,
                        explanation: "Le Pinot Noir est le cépage rouge emblématique de la Bourgogne, produisant certains des vins les plus prestigieux et recherchés au monde."
                    },
                    {
                        id: 3,
                        type: "multiple",
                        question: "Qu'est-ce qu'un millésime ?",
                        options: [
                            "Une technique de vinification",
                            "L'année de récolte du raisin",
                            "Un type de cépage",
                            "La forme spéciale de la bouteille"
                        ],
                        correctAnswer: 1,
                        explanation: "Le millésime désigne l'année de la récolte des raisins utilisés pour produire un vin. Il peut avoir un impact significatif sur la qualité et le caractère du vin en raison des conditions climatiques variables d'une année à l'autre."
                    },
                    // More questions...
                ]
            },
            regions: {
                name: "Régions Viticoles",
                description: "Testez vos connaissances sur les régions viticoles du monde entier",
                questions: [
                    {
                        id: 1,
                        type: "multiple",
                        question: "Quelle région est connue pour ses vins 'Super Toscans' ?",
                        options: [
                            "Piémont, Italie",
                            "Toscane, Italie",
                            "Veneto, Italie",
                            "Sicile, Italie"
                        ],
                        correctAnswer: 1,
                        explanation: "Les 'Super Toscans' sont des vins toscans qui ont commencé à être produits dans les années 1970, souvent avec des cépages non traditionnels comme le Cabernet Sauvignon, hors des réglementations d'appellation strictes de l'Italie."
                    },
                    // More questions...
                ]
            },
            visual: {
                name: "Quiz Visuel",
                description: "Identifiez les vins, cépages et régions à partir d'images",
                questions: [
                    {
                        id: 1,
                        type: "image",
                        question: "À quelle région viticole correspondent ces paysages ?",
                        images: [
                            "assets/images/quiz/region1.jpg",
                            "assets/images/quiz/region2.jpg",
                            "assets/images/quiz/region3.jpg",
                            "assets/images/quiz/region4.jpg"
                        ],
                        options: [
                            "Vallée du Rhône, France",
                            "Vallée de la Loire, France",
                            "Vallée de Napa, États-Unis",
                            "Vallée du Douro, Portugal"
                        ],
                        correctAnswer: 3,
                        explanation: "Ces images montrent les spectaculaires terrasses viticoles de la vallée du Douro au Portugal, célèbre pour la production de Porto et de vins de table rouges intenses."
                    },
                    // More questions...
                ]
            },
            expert: {
                name: "Mode Expert",
                description: "Pour les véritables connaisseurs, un défi de niveau sommelier",
                questions: [
                    {
                        id: 1,
                        type: "multiple",
                        question: "Quelle est la différence technique entre un Champagne 'Blanc de Blancs' et 'Blanc de Noirs' ?",
                        options: [
                            "Blanc de Blancs utilise uniquement des raisins blancs, Blanc de Noirs uniquement des raisins noirs",
                            "Blanc de Blancs est plus sec, Blanc de Noirs est plus doux",
                            "Blanc de Blancs est non millésimé, Blanc de Noirs est millésimé",
                            "Blanc de Blancs vieillit en fûts, Blanc de Noirs en cuves inox"
                        ],
                        correctAnswer: 0,
                        explanation: "Un Champagne Blanc de Blancs est produit exclusivement à partir de raisins blancs (Chardonnay), tandis qu'un Blanc de Noirs est élaboré uniquement à partir de raisins noirs (Pinot Noir et/ou Pinot Meunier) dont on n'utilise que le jus, incolore."
                    },
                    // More questions...
                ]
            }
        };
        
        // Main quiz application
        document.addEventListener('DOMContentLoaded', () => {
            // Quiz state
            const state = {
                quizMode: null,
                currentQuestions: [],
                currentQuestionIndex: 0,
                selectedAnswer: null,
                answers: [],
                score: 0,
                startTime: null,
                endTime: null
            };
            
            // DOM elements
            const elements = {
                // Quiz sections
                quizIntro: document.getElementById('quiz-intro'),
                quizContainer: document.getElementById('quiz-container'),
                quizResults: document.getElementById('quiz-results'),
                quizAromaWheel: document.getElementById('quiz-aroma-wheel'),
                
                // Quiz intro elements
                quizModeCards: document.querySelectorAll('.quiz-mode-card'),
                startQuizBtn: document.getElementById('start-quiz-btn'),
                
                // Quiz container elements
                progressSteps: document.getElementById('progress-steps'),
                progressFill: document.getElementById('progress-fill'),
                progressCurrent: document.getElementById('progress-current'),
                progressTotal: document.getElementById('progress-total'),
                questionContainer: document.getElementById('question-container'),
                feedbackContainer: document.getElementById('feedback-container'),
                submitAnswerBtn: document.getElementById('submit-answer-btn'),
                nextQuestionBtn: document.getElementById('next-question-btn'),
                
                // Results section elements
                resultScore: document.getElementById('score-value'),
                resultMessage: document.getElementById('result-message'),
                resultBadge: document.getElementById('result-badge'),
                expertiseLevelFill: document.getElementById('expertise-level-fill'),
                resultQuestions: document.getElementById('result-questions'),
                shareResultsBtn: document.getElementById('share-results-btn'),
                tryAgainBtn: document.getElementById('try-again-btn'),
                recommendationContainer: document.getElementById('recommendation-container'),
                
                // Aroma wheel elements
                aromaWheelContainer: document.getElementById('aroma-wheel-container'),
                closeAromaWheelBtn: document.getElementById('close-aroma-wheel-btn'),
                
                // Share modal elements
                shareModal: document.getElementById('share-modal'),
                shareModalClose: document.getElementById('share-modal-close'),
                shareButtons: document.querySelectorAll('.share-btn'),
                copyLinkBtn: document.getElementById('copy-link-btn'),
                shareLink: document.getElementById('share-link')
            };
            
            // Initialize quiz
            function initQuiz() {
                // Setup quiz mode selection
                elements.quizModeCards.forEach(card => {
                    card.addEventListener('click', () => {
                        // Remove selection from all cards
                        elements.quizModeCards.forEach(c => c.classList.remove('selected'));
                        
                        // Mark selected card
                        card.classList.add('selected');
                        
                        // Store selected mode
                        state.quizMode = card.getAttribute('data-mode');
                        
                        // Enable start button
                        elements.startQuizBtn.disabled = false;
                    });
                });
                
                // Start quiz button
                elements.startQuizBtn.addEventListener('click', startQuiz);
                
                // Submit answer button
                elements.submitAnswerBtn.addEventListener('click', submitAnswer);
                
                // Next question button
                elements.nextQuestionBtn.addEventListener('click', nextQuestion);
                
                // Try again button
                elements.tryAgainBtn.addEventListener('click', resetQuiz);
                
                // Share results button
                elements.shareResultsBtn.addEventListener('click', openShareModal);
                
                // Close share modal
                elements.shareModalClose.addEventListener('click', closeShareModal);
                
                // Share buttons
                elements.shareButtons.forEach(button => {
                    button.addEventListener('click', () => {
                        shareResults(button.getAttribute('data-platform'));
                    });
                });
                
                // Copy link button
                elements.copyLinkBtn.addEventListener('click', copyShareLink);
                
                // Close aroma wheel button
                elements.closeAromaWheelBtn.addEventListener('click', closeAromaWheel);
                
                // Close modal on click outside
                window.addEventListener('click', (event) => {
                    if (event.target === elements.shareModal) {
                        closeShareModal();
                    }
                });
                
                // Check if URL contains result parameters
                const urlParams = new URLSearchParams(window.location.search);
                if (urlParams.has('result') && urlParams.has('score')) {
                    // Show saved results
                    showSavedResults(urlParams.get('result'), urlParams.get('score'));
                }
            }
            
            // Start the quiz
            function startQuiz() {
                // Get questions for selected mode
                state.currentQuestions = [...quizData[state.quizMode].questions];
                
                // Shuffle questions for variety
                shuffleArray(state.currentQuestions);
                
                // Limit to 10 questions
                state.currentQuestions = state.currentQuestions.slice(0, 10);
                
                // Reset quiz state
                state.currentQuestionIndex = 0;
                state.selectedAnswer = null;
                state.answers = [];
                state.score = 0;
                state.startTime = new Date();
                
                // Update progress
                updateProgress();
                
                // Show first question
                showQuestion(state.currentQuestions[0]);
                
                // Show quiz container, hide intro
                elements.quizIntro.style.display = 'none';
                elements.quizContainer.style.display = 'block';
            }
            
            // Show a question
            function showQuestion(question) {
                // Clear previously selected answer
                state.selectedAnswer = null;
                
                // Enable/disable submit button
                elements.submitAnswerBtn.disabled = true;
                elements.submitAnswerBtn.style.display = 'block';
                elements.nextQuestionBtn.style.display = 'none';
                
                // Hide feedback
                elements.feedbackContainer.style.display = 'none';
                
                let html = '';
                
                if (question.type === 'multiple') {
                    // Multiple choice question
                    html = `
                        <h2 class="question-text">${question.question}</h2>
                        <div class="options">
                            ${question.options.map((option, index) => `
                                <div class="option" data-index="${index}">
                                    <input type="radio" name="answer" id="option-${index}" class="option-input">
                                    <label for="option-${index}" class="option-text">${option}</label>
                                </div>
                            `).join('')}
                        </div>
                    `;
                } else if (question.type === 'image') {
                    // Image-based question
                    html = `
                        <h2 class="question-text">${question.question}</h2>
                        <div class="image-options-grid">
                            ${question.images.map((image, index) => `
                                <div class="image-quiz-option" data-index="${index}">
                                    <img src="${image}" alt="Option ${index + 1}">
                                    <div class="image-quiz-option-label">${question.options[index]}</div>
                                </div>
                            `).join('')}
                        </div>
                    `;
                }
                
                // Add help link for aroma wheel if relevant
                if (question.question.toLowerCase().includes('arôme') || 
                    question.question.toLowerCase().includes('arome') || 
                    question.question.toLowerCase().includes('olfactif')) {
                    html += `
                        <div class="question-help mt-3">
                            <a href="#" id="show-aroma-wheel" class="btn-link">
                                <i class="fas fa-info-circle"></i> Consulter la roue des arômes
                            </a>
                        </div>
                    `;
                }
                
                // Set question HTML
                elements.questionContainer.innerHTML = html;
                
                // Add event listeners for options
                if (question.type === 'multiple') {
                    const options = elements.questionContainer.querySelectorAll('.option');
                    options.forEach(option => {
                        option.addEventListener('click', () => {
                            // Remove selection from all options
                            options.forEach(o => o.classList.remove('selected'));
                            
                            // Mark selected option
                            option.classList.add('selected');
                            
                            // Store selected answer
                            state.selectedAnswer = parseInt(option.getAttribute('data-index'));
                            
                            // Enable submit button
                            elements.submitAnswerBtn.disabled = false;
                        });
                    });
                } else if (question.type === 'image') {
                    const imageOptions = elements.questionContainer.querySelectorAll('.image-quiz-option');
                    imageOptions.forEach(option => {
                        option.addEventListener('click', () => {
                            // Remove selection from all options
                            imageOptions.forEach(o => o.classList.remove('selected'));
                            
                            // Mark selected option
                            option.classList.add('selected');
                            
                            // Store selected answer
                            state.selectedAnswer = parseInt(option.getAttribute('data-index'));
                            
                            // Enable submit button
                            elements.submitAnswerBtn.disabled = false;
                        });
                    });
                }
                
                // Add event listener for aroma wheel link if present
                const aromaWheelLink = elements.questionContainer.querySelector('#show-aroma-wheel');
                if (aromaWheelLink) {
                    aromaWheelLink.addEventListener('click', (e) => {
                        e.preventDefault();
                        showAromaWheel();
                    });
                }
            }
            
            // Submit answer
            function submitAnswer() {
                const currentQuestion = state.currentQuestions[state.currentQuestionIndex];
                
                // Store answer
                state.answers.push({
                    questionId: currentQuestion.id,
                    selectedAnswer: state.selectedAnswer,
                    correctAnswer: currentQuestion.correctAnswer,
                    isCorrect: state.selectedAnswer === currentQuestion.correctAnswer
                });
                
                // Update score
                if (state.selectedAnswer === currentQuestion.correctAnswer) {
                    state.score++;
                }
                
                // Show feedback
                showFeedback(currentQuestion);
                
                // Update UI
                elements.submitAnswerBtn.style.display = 'none';
                elements.nextQuestionBtn.style.display = 'block';
                
                // Mark correct/incorrect options
                if (currentQuestion.type === 'multiple') {
                    const options = elements.questionContainer.querySelectorAll('.option');
                    options.forEach((option, index) => {
                        const isSelected = index === state.selectedAnswer;
                        const isCorrect = index === currentQuestion.correctAnswer;
                        
                        if (isSelected) {
                            option.classList.add(isCorrect ? 'correct' : 'incorrect');
                        } else if (isCorrect) {
                            option.classList.add('correct');
                        }
                        
                        // Disable all options
                        option.classList.add('disabled');
                        const input = option.querySelector('input');
                        if (input) {
                            input.disabled = true;
                        }
                    });
                } else if (currentQuestion.type === 'image') {
                    const imageOptions = elements.questionContainer.querySelectorAll('.image-quiz-option');
                    imageOptions.forEach((option, index) => {
                        const isSelected = index === state.selectedAnswer;
                        const isCorrect = index === currentQuestion.correctAnswer;
                        
                        if (isSelected) {
                            option.classList.add(isCorrect ? 'correct' : 'incorrect');
                        } else if (isCorrect) {
                            option.classList.add('correct');
                        }
                        
                        // Disable all options
                        option.classList.add('disabled');
                    });
                }
                
                // Update progress
                updateProgress();
            }
            
            // Show feedback after answering
            function showFeedback(question) {
                const isCorrect = state.selectedAnswer === question.correctAnswer;
                const feedbackClass = isCorrect ? 'feedback-correct' : 'feedback-incorrect';
                
                elements.feedbackContainer.className = `quiz-feedback ${feedbackClass}`;
                elements.feedbackContainer.innerHTML = `
                    <div class="feedback-result">
                        ${isCorrect 
                            ? '<i class="fas fa-check-circle"></i> Bonne réponse !' 
                            : '<i class="fas fa-times-circle"></i> Mauvaise réponse !'}
                    </div>
                    <div class="feedback-explanation">
                        ${question.explanation}
                    </div>
                `;
                
                elements.feedbackContainer.style.display = 'block';
            }
            
            // Go to next question or end quiz
            function nextQuestion() {
                // Increment question index
                state.currentQuestionIndex++;
                
                // Check if quiz is finished
                if (state.currentQuestionIndex >= state.currentQuestions.length) {
                    finishQuiz();
                } else {
                    // Show next question
                    showQuestion(state.currentQuestions[state.currentQuestionIndex]);
                    updateProgress();
                }
            }
            
            // Update progress indicators
            function updateProgress() {
                const currentIndex = state.currentQuestionIndex;
                const totalQuestions = state.currentQuestions.length;
                
                // Update progress text
                elements.progressCurrent.textContent = `Question ${currentIndex + 1}`;
                elements.progressTotal.textContent = `sur ${totalQuestions}`;
                
                // Update progress bar
                const progressPercentage = (currentIndex / totalQuestions) * 100;
                elements.progressFill.style.width = `${progressPercentage}%`;
                
                // Update steps
                elements.progressSteps.innerHTML = '';
                for (let i = 0; i < totalQuestions; i++) {
                    const stepElement = document.createElement('div');
                    stepElement.className = 'progress-step';
                    
                    if (i < currentIndex) {
                        // Question already answered
                        stepElement.classList.add('completed');
                        stepElement.innerHTML = '<i class="fas fa-check"></i>';
                    } else if (i === currentIndex) {
                        // Current question
                        stepElement.classList.add('active');
                        stepElement.textContent = i + 1;
                    } else {
                        // Future question
                        stepElement.textContent = i + 1;
                    }
                    
                    elements.progressSteps.appendChild(stepElement);
                }
            }
            
            // Finish the quiz and show results
            function finishQuiz() {
                // Record end time
                state.endTime = new Date();
                
                // Calculate time taken
                const timeTaken = Math.floor((state.endTime - state.startTime) / 1000);
                
                // Hide quiz container
                elements.quizContainer.style.display = 'none';
                
                // Prepare and show results
                showResults(timeTaken);
            }
            
            // Show quiz results
            function showResults(timeTaken) {
                // Calculate score percentage
                const scorePercentage = (state.score / state.currentQuestions.length) * 100;
                
                // Determine expertise level
                let expertiseLevel, badgeClass, badgeIcon, resultMessage;
                
                if (scorePercentage < 30) {
                    expertiseLevel = 'Novice';
                    badgeClass = 'badge-novice';
                    badgeIcon = 'fas fa-glass-martini';
                    resultMessage = "N'abandonnez pas ! La dégustation du vin est un art qui s'apprend avec le temps et la pratique.";
                } else if (scorePercentage < 50) {
                    expertiseLevel = 'Amateur';
                    badgeClass = 'badge-amateur';
                    badgeIcon = 'fas fa-wine-bottle';
                    resultMessage = "Pas mal ! Vous avez déjà acquis quelques connaissances de base sur le vin.";
                } else if (scorePercentage < 70) {
                    expertiseLevel = 'Connaisseur';
                    badgeClass = 'badge-connoisseur';
                    badgeIcon = 'fas fa-wine-glass-alt';
                    resultMessage = "Bien joué ! Vous avez une belle connaissance du monde du vin.";
                } else if (scorePercentage < 90) {
                    expertiseLevel = 'Sommelier';
                    badgeClass = 'badge-sommelier';
                    badgeIcon = 'fas fa-wine-glass';
                    resultMessage = "Excellent ! Votre expertise œnologique est impressionnante.";
                } else {
                    expertiseLevel = 'Maître';
                    badgeClass = 'badge-master';
                    badgeIcon = 'fas fa-crown';
                    resultMessage = "Exceptionnel ! Vous êtes un véritable expert du vin. Même les sommeliers professionnels seraient impressionnés !";
                }
                
                // Update result elements
                elements.resultScore.textContent = `${state.score}/${state.currentQuestions.length}`;
                elements.resultMessage.textContent = resultMessage;
                
                // Create badge
                elements.resultBadge.innerHTML = `
                    <div class="quiz-badge ${badgeClass}">
                        <span class="badge-icon"><i class="${badgeIcon}"></i></span>
                        <span class="badge-title">${expertiseLevel}</span>
                        <span class="badge-subtitle">${state.score}/${state.currentQuestions.length}</span>
                    </div>
                `;
                
                // Update expertise level fill
                const expertiseLevelPercentage = getExpertiseLevelPercentage(expertiseLevel);
                elements.expertiseLevelFill.style.width = `${expertiseLevelPercentage}%`;
                
                // Display answered questions
                showAnsweredQuestions();
                
                // Show wine recommendations based on answers
                showRecommendations();
                
                // Show results section
                elements.quizResults.style.display = 'block';
                
                // Create confetti effect for high scores
                if (scorePercentage >= 70) {
                    createConfetti();
                }
                
                // Update share link
                elements.shareLink.value = `https://citeduvin.com/quiz?result=${expertiseLevel.toLowerCase()}&score=${state.score}`;
            }
            
            // Show answered questions in results
            function showAnsweredQuestions() {
                let html = '';
                
                state.answers.forEach((answer, index) => {
                    const question = state.currentQuestions.find(q => q.id === answer.questionId);
                    
                    html += `
                        <div class="result-question-item ${answer.isCorrect ? 'correct' : 'incorrect'}">
                            <div class="result-question-number">
                                <span class="question-number">${index + 1}</span>
                                <span class="question-indicator">
                                    ${answer.isCorrect 
                                        ? '<i class="fas fa-check-circle text-success"></i>' 
                                        : '<i class="fas fa-times-circle text-danger"></i>'}
                                </span>
                            </div>
                            <div class="result-question-content">
                                <div class="result-question-text">${question.question}</div>
                                <div class="result-question-answer">
                                    <strong>Votre réponse :</strong> ${question.options[answer.selectedAnswer]}
                                </div>
                                ${!answer.isCorrect ? `
                                    <div class="result-question-correct">
                                        <strong>Réponse correcte :</strong> ${question.options[question.correctAnswer]}
                                    </div>
                                ` : ''}
                            </div>
                        </div>
                    `;
                });
                
                elements.resultQuestions.innerHTML = html;
            }
            
            // Show wine recommendations based on answers
            function showRecommendations() {
                // Simplified recommendation logic based on quiz performance
                // In a real application, you would analyze specific answers to provide tailored recommendations
                
                // For demo purposes, show different wines based on score
                let wines = [];
                
                if (state.score < 3) {
                    wines = [
                        {
                            title: "Château de La Tour 2018",
                            region_1: "Bordeaux, France",
                            variety: "Merlot",
                            points: 88,
                            price: 22,
                            image: "assets/images/wine-placeholder.jpg"
                        },
                        {
                            title: "Domaine Laroche Chablis 2019",
                            region_1: "Bourgogne, France",
                            variety: "Chardonnay",
                            points: 87,
                            price: 25,
                            image: "assets/images/wine-placeholder.jpg"
                        },
                        {
                            title: "Villa Antinori Chianti Classico Riserva 2017",
                            region_1: "Toscane, Italie",
                            variety: "Sangiovese",
                            points: 90,
                            price: 28,
                            image: "assets/images/wine-placeholder.jpg"
                        }
                    ];
                } else if (state.score < 7) {
                    wines = [
                        {
                            title: "Domaine Drouhin Oregon Pinot Noir 2018",
                            region_1: "Willamette Valley, USA",
                            variety: "Pinot Noir",
                            points: 92,
                            price: 45,
                            image: "assets/images/wine-placeholder.jpg"
                        },
                        {
                            title: "Cloudy Bay Sauvignon Blanc 2021",
                            region_1: "Marlborough, Nouvelle-Zélande",
                            variety: "Sauvignon Blanc",
                            points: 91,
                            price: 32,
                            image: "assets/images/wine-placeholder.jpg"
                        },
                        {
                            title: "Château Beaucastel Châteauneuf-du-Pape 2019",
                            region_1: "Vallée du Rhône, France",
                            variety: "Grenache, Mourvèdre",
                            points: 95,
                            price: 89,
                            image: "assets/images/wine-placeholder.jpg"
                        }
                    ];
                } else {
                    wines = [
                        {
                            title: "Domaine de la Romanée-Conti La Tâche 2017",
                            region_1: "Bourgogne, France",
                            variety: "Pinot Noir",
                            points: 98,
                            price: 4200,
                            image: "assets/images/wine-placeholder.jpg"
                        },
                        {
                            title: "Château Lafite Rothschild 2016",
                            region_1: "Bordeaux, France",
                            variety: "Cabernet Sauvignon",
                            points: 97,
                            price: 850,
                            image: "assets/images/wine-placeholder.jpg"
                        },
                        {
                            title: "Sassicaia 2018",
                            region_1: "Toscane, Italie",
                            variety: "Cabernet Sauvignon",
                            points: 96,
                            price: 295,
                            image: "assets/images/wine-placeholder.jpg"
                        }
                    ];
                }
                
                // Generate HTML for recommendations
                let html = '';
                
                wines.forEach(wine => {
                    html += `
                        <div class="wine-card">
                            <div class="wine-image">
                                <img src="${wine.image}" alt="${wine.title}">
                            </div>
                            <div class="wine-content">
                                <div class="wine-meta">
                                    <span class="wine-region">${wine.region_1}</span>
                                </div>
                                <h3 class="wine-title">${wine.title}</h3>
                                <div class="wine-points">
                                    <span class="wine-points-value">${wine.points}</span>
                                    <span class="wine-points-label">pts</span>
                                </div>
                                <div class="wine-tags">
                                    <span class="wine-tag">${wine.variety}</span>
                                </div>
                                <div class="wine-footer">
                                    <div class="wine-price">€${wine.price}</div>
                                    <div class="wine-actions">
                                        <button class="btn primary add-btn">
                                            <i class="fas fa-shopping-cart"></i>
                                        </button>
                                        <button class="favorite-btn">
                                            <i class="far fa-heart"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                });
                
                elements.recommendationContainer.innerHTML = html;
            }
            
            // Reset quiz to start over
            function resetQuiz() {
                // Hide results section
                elements.quizResults.style.display = 'none';
                
                // Show intro section
                elements.quizIntro.style.display = 'block';
                
                // Reset selected mode
                elements.quizModeCards.forEach(card => card.classList.remove('selected'));
                elements.startQuizBtn.disabled = true;
                
                // Clear state
                state.quizMode = null;
            }
            
            // Show saved results from URL
            function showSavedResults(result, score) {
                // Set quiz mode to classic by default
                state.quizMode = 'classic';
                
                // Simulate quiz completion
                state.currentQuestions = quizData.classic.questions.slice(0, 10);
                state.currentQuestionIndex = state.currentQuestions.length;
                state.score = parseInt(score);
                
                // Generate fake answers
                state.answers = state.currentQuestions.map((question, index) => {
                    return {
                        questionId: question.id,
                        selectedAnswer: index < state.score ? question.correctAnswer : (question.correctAnswer + 1) % question.options.length,
                        correctAnswer: question.correctAnswer,
                        isCorrect: index < state.score
                    };
                });
                
                // Show results
                elements.quizIntro.style.display = 'none';
                showResults(0);
            }
            
            // Open share modal
            function openShareModal() {
                elements.shareModal.classList.add('show');
            }
            
            // Close share modal
            function closeShareModal() {
                elements.shareModal.classList.remove('show');
            }
            
            // Share results to social media
            function shareResults(platform) {
                const url = encodeURIComponent(elements.shareLink.value);
                const text = encodeURIComponent(`J'ai obtenu le niveau "${getExpertiseLevel()}" au quiz œnologique de la Cité du Vin!`);
                
                let shareUrl;
                
                switch (platform) {
                    case 'facebook':
                        shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${url}`;
                        break;
                    case 'twitter':
                        shareUrl = `https://twitter.com/intent/tweet?text=${text}&url=${url}`;
                        break;
                    case 'linkedin':
                        shareUrl = `https://www.linkedin.com/sharing/share-offsite/?url=${url}`;
                        break;
                    case 'email':
                        shareUrl = `mailto:?subject=${text}&body=${text}%0A%0A${url}`;
                        break;
                }
                
                window.open(shareUrl, '_blank');
            }
            
            // Copy share link to clipboard
            function copyShareLink() {
                elements.shareLink.select();
                document.execCommand('copy');
                
                // Show feedback
                const originalText = elements.copyLinkBtn.textContent;
                elements.copyLinkBtn.textContent = 'Copié !';
                setTimeout(() => {
                    elements.copyLinkBtn.textContent = originalText;
                }, 2000);
            }
            
            // Show aroma wheel
            function showAromaWheel() {
                // Hide quiz container
                elements.quizContainer.style.display = 'none';
                
                // Show aroma wheel section
                elements.quizAromaWheel.style.display = 'block';
                
                // Generate aroma wheel SVG
                generateAromaWheel();
            }
            
            // Close aroma wheel
            function closeAromaWheel() {
                // Hide aroma wheel section
                elements.quizAromaWheel.style.display = 'none';
                
                // Show quiz container
                elements.quizContainer.style.display = 'block';
            }
            
            // Generate the aroma wheel visualization
            function generateAromaWheel() {
                // Simple SVG aroma wheel for demonstration
                const aromaData = [
                    { name: "Fruits rouges", color: "#E57373", percentage: 20, items: ["Fraise", "Framboise", "Cerise", "Groseille"] },
                    { name: "Fruits noirs", color: "#9575CD", percentage: 15, items: ["Mûre", "Cassis", "Myrtille", "Prune"] },
                    { name: "Fruits jaunes", color: "#FFB74D", percentage: 15, items: ["Abricot", "Pêche", "Citron", "Mangue"] },
                    { name: "Floral", color: "#4FC3F7", percentage: 15, items: ["Rose", "Violette", "Jasmin", "Acacia"] },
                    { name: "Épices", color: "#f06292", percentage: 10, items: ["Poivre", "Cannelle", "Vanille", "Clou de girofle"] },
                    { name: "Végétal", color: "#AED581", percentage: 10, items: ["Herbe fraîche", "Menthe", "Feuille", "Poivron"] },
                    { name: "Boisé", color: "#A1887F", percentage: 10, items: ["Chêne", "Cèdre", "Fumé", "Tabac"] },
                    { name: "Terroir", color: "#90A4AE", percentage: 5, items: ["Cuir", "Champignon", "Sous-bois", "Minéral"] }
                ];
                
                const width = 600;
                const height = 600;
                const radius = Math.min(width, height) / 2;
                
                let html = `<svg width="${width}" height="${height}" viewBox="0 0 ${width} ${height}">`;
                
                // Calculate total percentage
                const total = aromaData.reduce((sum, d) => sum + d.percentage, 0);
                
                let startAngle = 0;
                
                // Generate pie segments
                aromaData.forEach((aroma, i) => {
                    const angle = (aroma.percentage / total) * 360;
                    const endAngle = startAngle + angle;
                    
                    // Calculate coordinates for arc
                    const startRad = (startAngle - 90) * (Math.PI / 180);
                    const endRad = (endAngle - 90) * (Math.PI / 180);
                    
                    const x1 = radius + radius * Math.cos(startRad);
                    const y1 = radius + radius * Math.sin(startRad);
                    const x2 = radius + radius * Math.cos(endRad);
                    const y2 = radius + radius * Math.sin(endRad);
                    
                    // Large arc flag is 1 if angle > 180 degrees
                    const largeArcFlag = angle > 180 ? 1 : 0;
                    
                    // Generate path
                    const path = `
                        M ${radius},${radius}
                        L ${x1},${y1}
                        A ${radius},${radius} 0 ${largeArcFlag} 1 ${x2},${y2}
                        Z
                    `;
                    
                    // Calculate text position
                    const textRad = (startAngle + angle / 2 - 90) * (Math.PI / 180);
                    const textX = radius + (radius * 0.7) * Math.cos(textRad);
                    const textY = radius + (radius * 0.7) * Math.sin(textRad);
                    
                    // Add segment
                    html += `
                        <path d="${path}" fill="${aroma.color}" stroke="#fff" stroke-width="1" 
                            data-name="${aroma.name}" data-items="${aroma.items.join(', ')}"></path>
                        <text x="${textX}" y="${textY}" text-anchor="middle" 
                            fill="#fff" font-size="12" font-weight="bold">${aroma.name}</text>
                    `;
                    
                    // Update start angle for next segment
                    startAngle = endAngle;
                });
                
                // Add center circle
                html += `
                    <circle cx="${radius}" cy="${radius}" r="${radius * 0.3}" 
                        fill="#fff" stroke="#ddd" stroke-width="1"></circle>
                    <text x="${radius}" y="${radius}" text-anchor="middle" 
                        font-size="16" font-weight="bold">Arômes du Vin</text>
                `;
                
                html += '</svg>';
                
                elements.aromaWheelContainer.innerHTML = html;
                
                // Add interactivity
                const paths = elements.aromaWheelContainer.querySelectorAll('path');
                paths.forEach(path => {
                    path.addEventListener('mouseover', (e) => {
                        const name = e.target.getAttribute('data-name');
                        const items = e.target.getAttribute('data-items');
                        
                        // Highlight segment
                        e.target.setAttribute('stroke', '#333');
                        e.target.setAttribute('stroke-width', '3');
                        
                        // Show tooltip
                        showAromaTooltip(name, items, e);
                    });
                    
                    path.addEventListener('mouseout', (e) => {
                        // Remove highlight
                        e.target.setAttribute('stroke', '#fff');
                        e.target.setAttribute('stroke-width', '1');
                        
                        // Hide tooltip
                        hideAromaTooltip();
                    });
                });
            }
            
            // Show aroma tooltip
            function showAromaTooltip(name, items, event) {
                // Remove existing tooltip
                hideAromaTooltip();
                
                // Create tooltip
                const tooltip = document.createElement('div');
                tooltip.className = 'aroma-tooltip';
                tooltip.innerHTML = `
                    <h4>${name}</h4>
                    <p>${items}</p>
                `;
                
                // Position tooltip near cursor
                tooltip.style.position = 'absolute';
                tooltip.style.left = `${event.pageX + 10}px`;
                tooltip.style.top = `${event.pageY + 10}px`;
                tooltip.style.backgroundColor = 'white';
                tooltip.style.padding = '10px';
                tooltip.style.borderRadius = '4px';
                tooltip.style.boxShadow = '0 2px 8px rgba(0,0,0,0.2)';
                tooltip.style.zIndex = '1000';
                tooltip.style.maxWidth = '200px';
                
                // Add to document
                document.body.appendChild(tooltip);
            }
            
            // Hide aroma tooltip
            function hideAromaTooltip() {
                const tooltip = document.querySelector('.aroma-tooltip');
                if (tooltip) {
                    tooltip.remove();
                }
            }
            
            // Create confetti effect
    function createConfetti() {
        const colors = ['#E57373', '#FFB74D', '#AED581', '#4FC3F7', '#9575CD', '#F06292'];
        const confettiCount = 200;
        
        for (let i = 0; i < confettiCount; i++) {
            const confetti = document.createElement('div');
            confetti.className = 'confetti';
            
            // Random position, color, size and animation
            confetti.style.left = `${Math.random() * 100}%`;
            confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
            
            // Vary size
            const size = Math.random() * 10 + 5;
            confetti.style.width = `${size}px`;
            confetti.style.height = `${size}px`;
            
            // Add some rotation to make them look more like confetti
            confetti.style.transform = `rotate(${Math.random() * 360}deg)`;
            
            // Different shapes
            if (Math.random() > 0.6) {
                confetti.style.borderRadius = '50%'; // Circle
            } else if (Math.random() > 0.5) {
                confetti.style.borderRadius = '0'; // Square
            } else {
                confetti.style.width = `${size / 3}px`;
                confetti.style.height = `${size}px`;
                confetti.style.borderRadius = '0'; // Rectangle
            }
            
            // Add to document
            document.body.appendChild(confetti);
            
            // Animate falling
            animateConfetti(confetti);
        }
    }
    
    // Animate confetti falling
    function animateConfetti(confetti) {
        // Random initial position
        const startX = parseFloat(confetti.style.left);
        const startY = -20; // Start above the screen
        
        // Random end position (simulating gravity and wind)
        const endX = startX + (Math.random() * 20 - 10);
        const endY = window.innerHeight + 20; // End below the screen
        
        // Random duration for more natural effect
        const duration = Math.random() * 3000 + 2000; // 2-5 seconds
        
        // Animation variables
        let startTime = null;
        
        // Animation function
        function animate(timestamp) {
            if (!startTime) startTime = timestamp;
            const progress = (timestamp - startTime) / duration;
            
            if (progress < 1) {
                // Calculate current position with some oscillation for swaying effect
                const x = startX + (endX - startX) * progress + Math.sin(progress * 10) * 15;
                const y = startY + (endY - startY) * progress;
                
                // Update position
                confetti.style.transform = `translate(${x - startX}px, ${y}px) rotate(${progress * 360 * 2}deg)`;
                
                // Continue animation
                requestAnimationFrame(animate);
            } else {
                // Remove confetti when animation completes
                confetti.remove();
            }
        }
        
        // Start animation
        requestAnimationFrame(animate);
    }
    
    // Helper function to get expertise level percentage
    function getExpertiseLevelPercentage(level) {
        switch (level) {
            case 'Novice': return 10;
            case 'Amateur': return 30;
            case 'Connoisseur': return 50;
            case 'Sommelier': return 75;
            case 'Maître': return 95;
            default: return 0;
        }
    }
    
    // Helper function to get expertise level based on score
    function getExpertiseLevel() {
        const scorePercentage = (state.score / state.currentQuestions.length) * 100;
        
        if (scorePercentage < 30) return 'Novice';
        if (scorePercentage < 50) return 'Amateur';
        if (scorePercentage < 70) return 'Connoisseur';
        if (scorePercentage < 90) return 'Sommelier';
        return 'Maître';
    }
    
    // Helper function to shuffle array
    function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
    }
    
    // Initialize quiz when DOM is loaded
    initQuiz();
});